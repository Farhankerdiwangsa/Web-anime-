<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TongDev | Stream - Gratis Bebas iklan</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bangers:wght@400&family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <style type="text/tailwindcss">
    @layer base {
      body {
        background-color: #FFF9E0;
        font-family: 'Inter', sans-serif;
        color: #000000;
        overflow-x: hidden;
        padding-bottom: 80px;
      }
    }
    @layer components {
      .comic-title-stroke {
        font-family: 'Bangers', cursive;
        letter-spacing: 1px;
        color: #FFD75C !important;
        text-shadow:
          2px 2px 0 #000,
          -2px -2px 0 #000,
          2px -2px 0 #000,
          -2px 2px 0 #000,
          2px 0 0 #000,
          -2px 0 0 #000,
          0 2px 0 #000,
          0 -2px 0 #000,
          1px 1px 2px rgba(0, 0, 0, 0.6);
      }
      .comic-border {
        border: 4px solid #000000;
      }
      .comic-shadow {
        box-shadow: 6px 6px 0px #000000;
      }
      .simple-dots-loader {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        width: 100%;
        height: 100%;
      }
      .simple-dots-loader span {
        width: 15px;
        height: 15px;
        background-color: #FFC300;
        border-radius: 50%;
        opacity: 0.3;
        animation: simple-bounce 1s infinite ease-in-out;
      }
      .simple-dots-loader span:nth-child(2) { animation-delay: 0.1s; }
      .simple-dots-loader span:nth-child(3) { animation-delay: 0.2s; }
      @keyframes simple-bounce {
        0%, 100% { transform: scale(0.5); opacity: 0.3; }
        50% { transform: scale(1); opacity: 1; }
      }
      .bottom-nav-item {
        @apply flex flex-col items-center justify-center p-2 text-textblack tap-highlight-transparent transition-transform duration-200 ease-out;
      }
      .bottom-nav-item .nav-icon {
        @apply text-2xl;
      }
      .bottom-nav-item .nav-text {
        @apply font-bangers text-lg tracking-wide;
      }
      .bottom-nav-item.active {
        @apply text-mustard;
        -webkit-text-stroke: 1px #000;
        text-shadow: 1px 1px 0 #000;
      }
    }
    @layer utilities {
      .tap-highlight-transparent {
        -webkit-tap-highlight-color: transparent;
      }
    }
  </style>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            mustard: '#FFC300',
            panel: '#FFF9E0',
            textblack: '#000000',
          },
          fontFamily: {
            bangers: ['Bangers', 'cursive'],
            inter: ['Inter', 'sans-serif'],
          }
        }
      }
    }
  </script>
</head>
<body class="bg-panel text-textblack font-inter">
  <div id="simple-loading-screen" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
    <div class="simple-dots-loader">
      <span></span><span></span><span></span>
    </div>
  </div>
  <div id="error-state" class="fixed inset-0 bg-mustard z-40 flex justify-center items-center p-4 hidden">
    <div class="bg-panel comic-border rounded-md p-8 sm:p-12 text-center text-textblack comic-shadow max-w-lg w-full">
      <div class="text-7xl sm:text-9xl">üö´</div>
      <div class="comic-title-stroke text-5xl sm:text-7xl text-mustard mt-4">
        Oops! Gagal Muat!
      </div>
      <div class="font-inter text-xl sm:text-2xl mt-6">
        Tidak bisa memuat data. Coba lagi nanti, ya!
      </div>
      <button id="retry-button" class="mt-10 bg-mustard font-bangers text-3xl px-10 py-3 comic-border rounded-md comic-shadow text-textblack comic-title-stroke tracking-wider transition-transform duration-200 hover:scale-105 active:scale-95">
        Coba Lagi
      </button>
    </div>
  </div>
  <div id="main-content" class="hidden">
    <header id="navbar" class="bg-mustard comic-border border-b-8 p-3 sm:p-4 md:p-6 flex flex-col lg:flex-row lg:items-center lg:justify-between shadow-lg sticky top-0 z-30">
      <a href="index.html" class="comic-title-stroke text-5xl sm:text-6xl lg:text-7xl text-textblack text-center lg:text-left tap-highlight-transparent">
        TongDev | Stream
      </a>
    </header>
    <section id="banner-slider" class="bg-mustard border-b-8 comic-border shadow-lg overflow-hidden relative w-full">
      <div id="slider-container" class="flex transition-transform duration-700 ease-in-out">
      </div>
      <div id="pagination-dots" class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-3 z-10">
      </div>
    </section>
    <section id="all-anime" class="px-4 py-6">
      <h2 class="text-center font-bold text-xl mb-4 text-black">Semua Anime & Movie</h2>
      <div id="anime-list" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
    </section>
    <nav id="bottom-navigation" class="fixed bottom-0 left-0 right-0 bg-mustard border-t-8 comic-border p-1 z-30 flex justify-around items-center comic-shadow" style="box-shadow: 0px -6px 0px #000000;">
      <a href="index.html" class="bottom-nav-item active" aria-current="page">
        <i class="fa-solid fa-house nav-icon"></i>
        <span class="nav-text">Home</span>
      </a>
      <a href="latest.html" class="bottom-nav-item">
        <i class="fa-solid fa-clock nav-icon"></i>
        <span class="nav-text">Terbaru</span>
      </a>
      <a href="search.html" class="bottom-nav-item">
        <i class="fa-solid fa-search nav-icon"></i>
        <span class="nav-text">Search</span>
      </a>
      <a href="populer.html" class="bottom-nav-item">
        <i class="fa-solid fa-star nav-icon"></i>
        <span class="nav-text">Populer</span>
      </a>
      <a href="auth.html" class="bottom-nav-item">
        <i class="fa-solid fa-user nav-icon"></i>
        <span class="nav-text">Profil</span>
      </a>
    </nav>
  </div>
  <script>
    const API_URL = "https://backend.syaii.my.id/api/homepage";
    function createAnimeCard(anime) {
        if (!anime || !anime.imageUrl || !anime.title || !anime.detailLink) {
            return '';
        }
        const placeholderImg = 'https://placehold.co/200x300/F0F0F0/000?text=Img+Error';
        return `
            <a href="detail.html?url=${encodeURIComponent(anime.detailLink)}" 
               class="block bg-white rounded-md shadow-lg overflow-hidden cursor-pointer transition-transform duration-300 ease-in-out hover:scale-105 tap-highlight-transparent">
                <div class="w-full aspect-[2/3] overflow-hidden">
                    <img src="${anime.imageUrl}" 
                         alt="${anime.title}" 
                         class="w-full h-full object-cover" 
                         onerror="this.src='${placeholderImg}'">
                </div>
                <div class="p-3 text-center">
                    <p class="text-sm font-inter font-semibold text-gray-900 truncate">${anime.title}</p>
                </div>
            </a>
        `;
    }
    async function loadAllAnimeGrid() {
      const loadingScreen = document.getElementById('simple-loading-screen');
      if (loadingScreen) loadingScreen.style.display = 'flex';
      try {
        const response = await fetch(API_URL);
        const data = await response.json();
        if (loadingScreen) loadingScreen.style.display = 'none';
        const allAnime = [
          ...(data.featuredAnime || []),
          ...(data.ongoingAnime || []),
          ...(data.finishedAnime || []),
          ...(data.movieAnime || [])
        ];
        const container = document.getElementById('anime-list');
        if (container) {
          container.innerHTML = allAnime.map(createAnimeCard).join('');
        }
      } catch (error) {
        if (loadingScreen) loadingScreen.style.display = 'none';
        console.error('Failed to load all anime grid:', error);
      }
    }
    document.addEventListener('DOMContentLoaded', () => {
      let sliderInterval;
      let currentSlide = 0;
      const TOTAL_SLIDES = 3;
      const loadingScreen = document.getElementById('simple-loading-screen');
      const errorState = document.getElementById('error-state');
      const mainContent = document.getElementById('main-content');
      const retryButton = document.getElementById('retry-button');
      const sliderContainer = document.getElementById('slider-container');
      const paginationDotsContainer = document.getElementById('pagination-dots');
      async function loadHomepageData() {
        showLoading();
        try {
          const response = await fetch(API_URL);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();
          const featured = data.featuredAnime && data.featuredAnime[0] ? data.featuredAnime[0] : null;
          const ongoing = data.ongoingAnime && data.ongoingAnime[0] ? data.ongoingAnime[0] : null;
          const movie = data.movieAnime && data.movieAnime[0] ? data.movieAnime[0] : null;
          sliderContainer.innerHTML = '';
          if (featured) renderFeatured(featured);
          if (ongoing) renderOngoing(ongoing);
          if (movie) renderMovie(movie);
          setupSlider();
          showContent();
        } catch (error) {
          console.error("Error loading homepage data:", error);
          showError();
        }
        loadAllAnimeGrid();
      }
      function showLoading() {
        if (loadingScreen) loadingScreen.style.display = 'flex';
        errorState.classList.add('hidden');
        mainContent.classList.add('hidden');
      }
      function showError() {
        if (loadingScreen) loadingScreen.style.display = 'none';
        errorState.classList.remove('hidden');
        mainContent.classList.add('hidden');
        errorState.style.opacity = 0;
        errorState.style.transform = 'scale(0.9)';
        setTimeout(() => {
            errorState.style.transition = 'opacity 0.5s ease-out, transform 0.5s ease-out';
            errorState.style.opacity = 1;
            errorState.style.transform = 'scale(1)';
        }, 50);
      }
      function showContent() {
        if (loadingScreen) {
          loadingScreen.style.transition = 'opacity 0.3s ease-in';
          loadingScreen.style.opacity = 0;
          setTimeout(() => {
            loadingScreen.style.display = 'none';
            mainContent.classList.remove('hidden');
            errorState.classList.add('hidden');
            loadingScreen.style.transition = '';
            loadingScreen.style.opacity = 1;
          }, 300);
        } else {
            mainContent.classList.remove('hidden');
            errorState.classList.add('hidden');
        }
      }
      function renderFeatured(item) {
        const slideHTML = createBannerSlide(
          item.title,
          item.imageUrl,
          item.detailLink,
          "Unggulan",
          item.description,
          item.imageUrl
        );
        sliderContainer.innerHTML += slideHTML;
      }
      function renderOngoing(item) {
        const infoText = `${item.episodeInfo} | ${item.type} | ${item.quality}`;
        const slideHTML = createBannerSlide(
          item.title,
          item.imageUrl,
          item.detailLink,
          "Sedang Tayang",
          infoText,
          item.imageUrl
        );
        sliderContainer.innerHTML += slideHTML;
      }
      function renderMovie(item) {
        const infoText = `‚≠ê ${item.rating} | ${item.type} | ${item.quality}`;
        const slideHTML = createBannerSlide(
          item.title,
          item.imageUrl,
          item.detailLink,
          "Film (Movie)",
          infoText,
          item.imageUrl
        );
        sliderContainer.innerHTML += slideHTML;
      }
      function createBannerSlide(title, thumbUrl, detailLink, badgeText, infoText, backgroundUrl) {
        const placeholder = 'https://placehold.co/400x600/FFF9E0/000?text=TongDev';
        const bgUrl = backgroundUrl || thumbUrl;
        const link = detailLink ? `detail.html?url=${encodeURIComponent(detailLink)}` : '#';
        return `
        <div class="min-w-full px-2">
          <div class="relative block w-full aspect-[2/1] md:aspect-[21/9] overflow-hidden comic-border rounded-md comic-shadow bg-mustard group tap-highlight-transparent">
            <img src="${bgUrl || placeholder}"
                 alt="Background for ${title}"
                 class="absolute inset-0 w-full h-full object-cover filter blur-lg scale-105 transition-transform duration-500 ease-in-out group-hover:scale-110"
                 onerror="this.src='${placeholder}'">
            <div class="absolute inset-0 w-full h-full bg-black/40 backdrop-blur-sm"></div>
            <div class="relative z-10 w-full h-full p-4 sm:p-8 md:p-12 flex flex-col md:flex-row items-center justify-start text-white">
              <img src="${thumbUrl || placeholder}"
                   alt="${title}"
                   class="block h-40 sm:h-56 md:h-full aspect-[2/3] object-cover border-4 border-black rounded-md shadow-lg flex-shrink-0"
                   onerror="this.src='${placeholder}'">
              <div class="md:ml-8 lg:ml-12 mt-4 md:mt-0 text-left w-full md:w-auto">
                <span class="font-bangers text-lg sm:text-xl text-textblack bg-mustard border-2 border-black rounded-full px-4 py-1 inline-block comic-shadow">
                  ${badgeText}
                </span>
                <h3 class="comic-title-stroke text-3xl sm:text-4xl lg:text-6xl text-mustard mt-2" title="${title}">
                  ${title}
                </h3>
                <p class="font-inter font-bold text-base sm:text-xl lg:text-2xl text-white bg-black/50 border-2 border-white/50 rounded-lg px-4 py-2 inline-block mt-4 max-w-lg">
                  ${infoText}
                </p>
                <br>
                <a href="${link}" class="mt-4 inline-block bg-mustard font-bangers text-2xl px-8 py-2 comic-border rounded-md comic-shadow text-textblack comic-title-stroke tracking-wider transition-transform duration-200 hover:scale-105 active:scale-95">
                  Lihat Detail
                </a>
              </div>
            </div>
          </div>
        </div>
        `;
      }
      function setupSlider() {
        paginationDotsContainer.innerHTML = '';
        for (let i = 0; i < TOTAL_SLIDES; i++) {
          const dot = document.createElement('button');
          dot.classList.add('w-4', 'h-4', 'rounded-full', 'comic-border', 'border-2', 'transition-all', 'duration-300');
          dot.classList.add(i === 0 ? 'bg-textblack' : 'bg-white');
          dot.addEventListener('click', () => {
            goToSlide(i);
            resetSliderInterval();
          });
          paginationDotsContainer.appendChild(dot);
        }
        resetSliderInterval();
      }
      function goToSlide(slideIndex) {
        currentSlide = slideIndex % TOTAL_SLIDES;
        sliderContainer.style.transform = `translateX(-${currentSlide * 100}%)`;
        Array.from(paginationDotsContainer.children).forEach((dot, index) => {
          dot.classList.toggle('bg-textblack', index === currentSlide);
          dot.classList.toggle('bg-white', index !== currentSlide);
        });
      }
      function resetSliderInterval() {
        clearInterval(sliderInterval);
        sliderInterval = setInterval(() => {
          goToSlide(currentSlide + 1);
        }, 5000);
      }
      retryButton.addEventListener('click', () => {
        errorState.style.transition = 'opacity 0.3s ease-in, transform 0.3s ease-in';
        errorState.style.opacity = 0;
        errorState.style.transform = 'scale(0.8)';
        setTimeout(() => {
          errorState.style.display = 'none';
          errorState.style.opacity = 1;
          errorState.style.transform = 'scale(1)';
          errorState.style.transition = '';
          loadHomepageData();
        }, 300);
      });
      loadHomepageData();
    });
  </script>
</body>
</html>